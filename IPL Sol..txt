Q1- create table matches?
CREATE TABLE matches(
id INT ,
city VARCHAR,
date date,
player_of_match varchar,
venue varchar,
neutral_venue int,
team1 varchar,
team2 varchar,
toss_winner varchar,
toss_decision varchar, 
winner varchar,
result varchar,
result_margin int ,
eliminator varchar, 
method varchar ,
umpire1 varchar ,
umpire2 varchar);

Q2- create table deliveries?
CREATE TABLE deliveries(
id INT,
inning int,
over int,
ball int,
batsman varchar,
non_strike varchar,
bowler varchar,
batsman_runs int,
extra_runs int,
total_runs int,
is_wicket int,
dismissal_kind varchar,
player_dismissed varchar,
fielder varchar,
extras_type varchar,
batting_team varchar,
bowling_team varchar);

Q3- import data matches?
COPY matches FROM 'C:\Program Files\PostgreSQL\15\data\data_copy\IPL_matches.csv' CSV HEADER;

Q4- import data ball?
COPY deliveries FROM 'C:\Program Files\PostgreSQL\15\data\data_copy\IPL_Ball.csv' CSV HEADER;

Q5- top 20 rows deliveries table with ASC?
SELECT * FROM deliveries
ORDER BY id, inning, over, ball ASC
LIMIT 20;

Q6- top 20 rows matches?
SELECT * FROM matches
LIMIT 20;

Q7- match play on 02-may-2013 from matches table?
SELECT * FROM matches
WHERE date='2013-05-02';

Q8- data where result is runs and victory is more than 100?
SELECT * FROM matches
WHERE result='runs' and victory>100;

Q9- data where match tied and date DESC?
SELECT * FROM matches
WHERE result = 'tie'
ORDER BY date DESC;

Q10- count cities that have hosted an ipl?
SELECT city, COUNT(city)AS total_host FROM matches
GROUP BY city;

Q11- Create new table with all of delivers and new column with values depend on total runs?
CREATE TABLE deliveries_v02 AS
SELECT * FROM deliveries;

ALTER TABLE deliveries
ADD ball_result varchar;
UPDATE deliveries
SET ball_result= CASE
WHEN total_runs>=4 THEN 'boundary'
WHEN total_runs=0 THEN 'dot'
ELSE 'other'
END;

Q12- Total number of boundaries and dot balls?
SELECT ball_result, COUNT(ball_result)AS total FROM deliveries_v02
WHERE ball_result='boundary' or ball_result='dot'
GROUP BY ball_result;

Q13- Total number boundaries scored by each team and DESC on the bases of boundaries?
SELECT batting_team, COUNT(ball_result)AS boundaries FROM deliveries_v02
WHERE ball_result='boundary'
GROUP BY batting_team
ORDER BY boundaries DESC;

Q14- total number dot ball by each team and DESC on the bases od dot ball?
SELECT bowling_team, COUNT(ball_result)AS dot FROM deliveries_v02
WHERE ball_result='dot'
GROUP BY bowling_team
ORDER BY dot DESC;

Q15- total number of dismissals where dismissal kind is not na?
SELECT COUNT(dismissal_kind)AS total_dismissal FROM deliveries_v02
WHERE NOT dismissal_kind='NA';

Q16- top 5 bowlers who conceded maximum extra runs?
SELECT bowler, extra_runs FROM deliveries
ORDER BY extra_runs DESC
LIMIT 5;

Q17- create new table with all deliveries_v02 and two additional column venue and mattch_date?
CREATE TABLE delivers_v03 AS
SELECT deliveries_v02.*,
matches.venue,
matches.date
FROM deliveries_v02
LEFT JOIN matches
ON deliveries_v02.id = matches.id;

Q18- total run scored by each venue and DESC in total run?
SELECT venue, COUNT(total_runs)AS totalrun FROM delivers_v03
GROUP BY venue
ORDER BY totalrun DESC;

Q19- year-wise total runs scored at eden gardens and DESC total runs?
SELECT EXTRACT(year from date)AS matchyear, COUNT(total_runs)AS totalruns FROM delivers_v03
WHERE venue='Eden Gardens'
GROUP BY matchyear
ORDER BY totalruns DESC;

Q20-

Q21-

Q22-

Q23-

Q24-

Q25-